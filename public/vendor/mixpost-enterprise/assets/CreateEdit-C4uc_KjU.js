import{x as B,i as E,y as N,r as S,T,l as j,I as F,c as P,a,u as e,b as n,d as t,w as D,F as I,f as k,Z as L,g as s,t as u,p as M,q as W,h as d,k as m,j as _,m as A}from"./app-ByuBUqrL.js";import{u as O}from"./usePageMode-CYQMu83q.js";import{_ as Z}from"./PageHeader-CN-6eb5e.js";import{_ as z}from"./Panel-BpEjWyUt.js";import{_ as G}from"./Textarea-DD6LWbZU.js";import{_ as c}from"./LabelSuffix-9bL4Jy5O.js";import{_ as H}from"./ReceiptAction-DWOR1Uu2.js";import{_ as J}from"./SelectWorkspace-7JpHW5OW.js";import"./Flex-DzNCiE-H.js";import"./Trash-Ep8Ewxdj.js";import"./ArrowDownTray-Da1KHOuq.js";import"./Eye-BezOvdnp.js";const K={class:"row-py w-full mx-auto"},Q={class:"row-px"},R={for:"invoice_number"},X={for:"transaction_id"},Y={for:"amount"},h={for:"tax"},ee={for:"description"},te={for:"paid_at"},ae={class:"mt-lg"},_e={__name:"CreateEdit",props:{mode:{required:!0,type:String,default:"create"},defaultCurrency:{required:!0,type:String},currencies:{required:!0,type:Array},receipt:{type:Object}},setup(g){const p=g,{t:i}=B(),w=E("routePrefix"),v=N(()=>V.value?i("finance.create_receipt"):i("finance.edit_receipt")),{isCreate:V,isEdit:f}=O(),b=S(f.value&&p.receipt.workspace?{key:p.receipt.workspace.uuid,label:p.receipt.workspace.name}:null),r=T(f.value?j.cloneDeep(p.receipt):{workspace_uuid:null,transaction_id:"",invoice_number:"",amount:0,tax:0,currency:p.defaultCurrency,description:"",paid_at:"",paid_at_raw:""}),y=()=>r.transform(x=>({...x,workspace_uuid:b.value?b.value.key:null,paid_at:r.paid_at_raw})),$=()=>{y().post(route(`${w}.receipts.store`))},q=()=>{y().put(route(`${w}.receipts.update`,{receipt:p.receipt.uuid}))},U=()=>{V.value&&$(),f.value&&q()};return(x,l)=>{const C=F("v-select");return k(),P(I,null,[a(e(L),{title:v.value},null,8,["title"]),n("div",K,[a(Z,{title:v.value,flexWrap:!0},{description:t(()=>[s(u(e(f)?g.receipt.order_id:""),1)]),default:t(()=>[e(f)?(k(),M(H,{key:0,receipt:g.receipt,edit:!1},null,8,["receipt"])):W("",!0)]),_:1},8,["title"]),n("div",Q,[n("form",{method:"post",onSubmit:D(U,["prevent"])},[a(z,null,{title:t(()=>[s(u(e(i)("general.details")),1)]),default:t(()=>[a(d,null,{title:t(()=>[n("label",null,[s(u(e(i)("workspace.workspace"))+" ",1),a(c,{danger:""},{default:t(()=>l[8]||(l[8]=[s("*")])),_:1})])]),footer:t(()=>[a(m,{message:e(r).errors.workspace_uuid},null,8,["message"])]),default:t(()=>[a(J,{modelValue:b.value,"onUpdate:modelValue":l[0]||(l[0]=o=>b.value=o),disabled:e(f)},null,8,["modelValue","disabled"])]),_:1}),a(d,{class:"mt-lg"},{title:t(()=>[n("label",R,[s(u(e(i)("finance.invoice_number"))+" ",1),a(c,{danger:""},{default:t(()=>l[9]||(l[9]=[s("*")])),_:1})])]),footer:t(()=>[a(m,{message:e(r).errors.invoice_number},null,8,["message"])]),default:t(()=>[a(_,{modelValue:e(r).invoice_number,"onUpdate:modelValue":l[1]||(l[1]=o=>e(r).invoice_number=o),type:"text",id:"invoice_number",class:"w-full",autocomplete:"off",autofocus:e(V),required:""},null,8,["modelValue","autofocus"])]),_:1}),a(d,{class:"mt-lg"},{title:t(()=>[n("label",X,[s(u(e(i)("finance.transaction_id"))+" ",1),a(c,{danger:""},{default:t(()=>l[10]||(l[10]=[s("*")])),_:1})])]),footer:t(()=>[a(m,{message:e(r).errors.transaction_id},null,8,["message"])]),default:t(()=>[a(_,{modelValue:e(r).transaction_id,"onUpdate:modelValue":l[2]||(l[2]=o=>e(r).transaction_id=o),type:"text",id:"transaction_id",class:"w-full",autocomplete:"off",required:""},null,8,["modelValue"])]),_:1}),a(d,{class:"mt-lg"},{title:t(()=>[n("label",Y,[s(u(e(i)("finance.amount"))+" ",1),a(c,{danger:""},{default:t(()=>l[11]||(l[11]=[s("*")])),_:1})])]),footer:t(()=>[a(m,{message:e(r).errors.amount},null,8,["message"])]),default:t(()=>[a(_,{modelValue:e(r).amount,"onUpdate:modelValue":l[3]||(l[3]=o=>e(r).amount=o),type:"text",id:"amount",class:"w-full",required:""},null,8,["modelValue"])]),_:1}),a(d,{class:"mt-lg"},{title:t(()=>[n("label",h,[s(u(e(i)("finance.tax"))+" ",1),a(c,{danger:""},{default:t(()=>l[12]||(l[12]=[s("*")])),_:1})])]),footer:t(()=>[a(m,{message:e(r).errors.tax},null,8,["message"])]),default:t(()=>[a(_,{modelValue:e(r).tax,"onUpdate:modelValue":l[4]||(l[4]=o=>e(r).tax=o),type:"text",id:"tax",class:"w-full",required:""},null,8,["modelValue"])]),_:1}),a(d,{class:"mt-lg"},{title:t(()=>[s(u(e(i)("finance.currency")),1)]),footer:t(()=>[a(m,{message:e(r).errors.currency},null,8,["message"])]),default:t(()=>[a(C,{modelValue:e(r).currency,"onUpdate:modelValue":l[5]||(l[5]=o=>e(r).currency=o),reduce:o=>o.key,options:g.currencies,"close-on-select":!0,clearable:!1,searchable:!0,class:"w-full"},null,8,["modelValue","reduce","options"])]),_:1}),a(d,{class:"mt-lg"},{title:t(()=>[n("label",ee,[s(u(e(i)("general.description"))+" ",1),a(c,{danger:""},{default:t(()=>l[13]||(l[13]=[s("*")])),_:1})])]),footer:t(()=>[a(m,{message:e(r).errors.description},null,8,["message"])]),default:t(()=>[a(G,{modelValue:e(r).description,"onUpdate:modelValue":l[6]||(l[6]=o=>e(r).description=o),id:"description",class:"w-full",required:""},null,8,["modelValue"])]),_:1}),a(d,{class:"mt-lg"},{title:t(()=>[n("label",te,[s(u(e(i)("finance.paid_at"))+" ",1),a(c,{danger:""},{default:t(()=>l[14]||(l[14]=[s("*")])),_:1})])]),footer:t(()=>[a(m,{message:e(r).errors.paid_at},null,8,["message"])]),default:t(()=>[a(_,{modelValue:e(r).paid_at_raw,"onUpdate:modelValue":l[7]||(l[7]=o=>e(r).paid_at_raw=o),type:"datetime-local",id:"paid_at",class:"w-full"},null,8,["modelValue"])]),_:1}),n("div",ae,[a(A,{type:"submit",disabled:e(r).processing,isLoading:e(r).processing},{default:t(()=>[s(u(e(V)?e(i)("general.create"):e(i)("workspace.update")),1)]),_:1},8,["disabled","isLoading"])])]),_:1})],32)])])],64)}}};export{_e as default};
